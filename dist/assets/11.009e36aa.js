var s={name:"\u6D4F\u89C8\u5668\u57FA\u7840\u77E5\u8BC6\u70B9\u53CA\u5E38\u8003\u9762\u8BD5\u9898",content:`<style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre>code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote>p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><h1 data-id="heading-0">\u6D4F\u89C8\u5668\u57FA\u7840\u77E5\u8BC6\u70B9\u53CA\u5E38\u8003\u9762\u8BD5\u9898</h1>
<p>\u8FD9\u4E00\u7AE0\u8282\u6211\u4EEC\u5C06\u4F1A\u6765\u5B66\u4E60\u6D4F\u89C8\u5668\u7684\u4E00\u4E9B\u57FA\u7840\u77E5\u8BC6\u70B9\uFF0C\u5305\u62EC\uFF1A\u4E8B\u4EF6\u673A\u5236\u3001\u8DE8\u57DF\u3001\u5B58\u50A8\u76F8\u5173\uFF0C\u8FD9\u51E0\u4E2A\u77E5\u8BC6\u70B9\u4E5F\u662F\u9762\u8BD5\u7ECF\u5E38\u4F1A\u8003\u5230\u7684\u5185\u5BB9\u3002</p>
<h2 data-id="heading-1">\u4E8B\u4EF6\u673A\u5236</h2>
<pre><code class="hljs language-!" lang="!">\u6D89\u53CA\u9762\u8BD5\u9898\uFF1A\u4E8B\u4EF6\u7684\u89E6\u53D1\u8FC7\u7A0B\u662F\u600E\u4E48\u6837\u7684\uFF1F\u77E5\u9053\u4EC0\u4E48\u662F\u4E8B\u4EF6\u4EE3\u7406\u561B\uFF1F
</code></pre>
<h3 data-id="heading-2">\u4E8B\u4EF6\u89E6\u53D1\u4E09\u9636\u6BB5</h3>
<p>\u4E8B\u4EF6\u89E6\u53D1\u6709\u4E09\u4E2A\u9636\u6BB5\uFF1A</p>
<ul>
<li><code>window</code> \u5F80\u4E8B\u4EF6\u89E6\u53D1\u5904\u4F20\u64AD\uFF0C\u9047\u5230\u6CE8\u518C\u7684\u6355\u83B7\u4E8B\u4EF6\u4F1A\u89E6\u53D1</li>
<li>\u4F20\u64AD\u5230\u4E8B\u4EF6\u89E6\u53D1\u5904\u65F6\u89E6\u53D1\u6CE8\u518C\u7684\u4E8B\u4EF6</li>
<li>\u4ECE\u4E8B\u4EF6\u89E6\u53D1\u5904\u5F80 <code>window</code> \u4F20\u64AD\uFF0C\u9047\u5230\u6CE8\u518C\u7684\u5192\u6CE1\u4E8B\u4EF6\u4F1A\u89E6\u53D1</li>
</ul>
<p>\u4E8B\u4EF6\u89E6\u53D1\u4E00\u822C\u6765\u8BF4\u4F1A\u6309\u7167\u4E0A\u9762\u7684\u987A\u5E8F\u8FDB\u884C\uFF0C\u4F46\u662F\u4E5F\u6709\u7279\u4F8B\uFF0C<strong>\u5982\u679C\u7ED9\u4E00\u4E2A <code>body</code> \u4E2D\u7684\u5B50\u8282\u70B9\u540C\u65F6\u6CE8\u518C\u5192\u6CE1\u548C\u6355\u83B7\u4E8B\u4EF6\uFF0C\u4E8B\u4EF6\u89E6\u53D1\u4F1A\u6309\u7167\u6CE8\u518C\u7684\u987A\u5E8F\u6267\u884C\u3002</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// \u4EE5\u4E0B\u4F1A\u5148\u6253\u5370\u5192\u6CE1\u7136\u540E\u662F\u6355\u83B7</span>
node.addEventListener(
  <span class="hljs-string">'click'</span>,
  <span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'\u5192\u6CE1'</span>)
  },
  <span class="hljs-literal">false</span>
)
node.addEventListener(
  <span class="hljs-string">'click'</span>,
  <span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'\u6355\u83B7 '</span>)
  },
  <span class="hljs-literal">true</span>
)
</code></pre>
<h3 data-id="heading-3">\u6CE8\u518C\u4E8B\u4EF6</h3>
<p>\u901A\u5E38\u6211\u4EEC\u4F7F\u7528 <code>addEventListener</code> \u6CE8\u518C\u4E8B\u4EF6\uFF0C\u8BE5\u51FD\u6570\u7684\u7B2C\u4E09\u4E2A\u53C2\u6570\u53EF\u4EE5\u662F\u5E03\u5C14\u503C\uFF0C\u4E5F\u53EF\u4EE5\u662F\u5BF9\u8C61\u3002\u5BF9\u4E8E\u5E03\u5C14\u503C <code>useCapture</code> \u53C2\u6570\u6765\u8BF4\uFF0C\u8BE5\u53C2\u6570\u9ED8\u8BA4\u503C\u4E3A <code>false</code> \uFF0C<code>useCapture</code> \u51B3\u5B9A\u4E86\u6CE8\u518C\u7684\u4E8B\u4EF6\u662F\u6355\u83B7\u4E8B\u4EF6\u8FD8\u662F\u5192\u6CE1\u4E8B\u4EF6\u3002\u5BF9\u4E8E\u5BF9\u8C61\u53C2\u6570\u6765\u8BF4\uFF0C\u53EF\u4EE5\u4F7F\u7528\u4EE5\u4E0B\u51E0\u4E2A\u5C5E\u6027</p>
<ul>
<li><code>capture</code>\uFF1A\u5E03\u5C14\u503C\uFF0C\u548C <code>useCapture</code> \u4F5C\u7528\u4E00\u6837</li>
<li><code>once</code>\uFF1A\u5E03\u5C14\u503C\uFF0C\u503C\u4E3A <code>true</code> \u8868\u793A\u8BE5\u56DE\u8C03\u53EA\u4F1A\u8C03\u7528\u4E00\u6B21\uFF0C\u8C03\u7528\u540E\u4F1A\u79FB\u9664\u76D1\u542C</li>
<li><code>passive</code>\uFF1A\u5E03\u5C14\u503C\uFF0C\u8868\u793A\u6C38\u8FDC\u4E0D\u4F1A\u8C03\u7528 <code>preventDefault</code></li>
</ul>
<p>\u4E00\u822C\u6765\u8BF4\uFF0C\u5982\u679C\u6211\u4EEC\u53EA\u5E0C\u671B\u4E8B\u4EF6\u53EA\u89E6\u53D1\u5728\u76EE\u6807\u4E0A\uFF0C\u8FD9\u65F6\u5019\u53EF\u4EE5\u4F7F\u7528 <code>stopPropagation</code> \u6765\u963B\u6B62\u4E8B\u4EF6\u7684\u8FDB\u4E00\u6B65\u4F20\u64AD\u3002\u901A\u5E38\u6211\u4EEC\u8BA4\u4E3A <code>stopPropagation</code> \u662F\u7528\u6765\u963B\u6B62\u4E8B\u4EF6\u5192\u6CE1\u7684\uFF0C\u5176\u5B9E\u8BE5\u51FD\u6570\u4E5F\u53EF\u4EE5\u963B\u6B62\u6355\u83B7\u4E8B\u4EF6\u3002<code>stopImmediatePropagation</code> \u540C\u6837\u4E5F\u80FD\u5B9E\u73B0\u963B\u6B62\u4E8B\u4EF6\uFF0C\u4F46\u662F\u8FD8\u80FD\u963B\u6B62\u8BE5\u4E8B\u4EF6\u76EE\u6807\u6267\u884C\u522B\u7684\u6CE8\u518C\u4E8B\u4EF6\u3002</p>
<pre><code class="hljs language-js" lang="js">node.addEventListener(
  <span class="hljs-string">'click'</span>,
  <span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> {
    event.stopImmediatePropagation()
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'\u5192\u6CE1'</span>)
  },
  <span class="hljs-literal">false</span>
)
<span class="hljs-comment">// \u70B9\u51FB node \u53EA\u4F1A\u6267\u884C\u4E0A\u9762\u7684\u51FD\u6570\uFF0C\u8BE5\u51FD\u6570\u4E0D\u4F1A\u6267\u884C</span>
node.addEventListener(
  <span class="hljs-string">'click'</span>,
  <span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'\u6355\u83B7 '</span>)
  },
  <span class="hljs-literal">true</span>
)
</code></pre>
<h3 data-id="heading-4">\u4E8B\u4EF6\u4EE3\u7406</h3>
<p>\u5982\u679C\u4E00\u4E2A\u8282\u70B9\u4E2D\u7684\u5B50\u8282\u70B9\u662F\u52A8\u6001\u751F\u6210\u7684\uFF0C\u90A3\u4E48\u5B50\u8282\u70B9\u9700\u8981\u6CE8\u518C\u4E8B\u4EF6\u7684\u8BDD<strong>\u5E94\u8BE5\u6CE8\u518C\u5728\u7236\u8282\u70B9\u4E0A</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"ul"</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>4<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>5<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
	<span class="hljs-keyword">let</span> ul = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#ul'</span>)
	ul.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
		<span class="hljs-built_in">console</span>.log(event.target);
	})
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>\u4E8B\u4EF6\u4EE3\u7406\u7684\u65B9\u5F0F\u76F8\u8F83\u4E8E\u76F4\u63A5\u7ED9\u76EE\u6807\u6CE8\u518C\u4E8B\u4EF6\u6765\u8BF4\uFF0C\u6709\u4EE5\u4E0B\u4F18\u70B9\uFF1A</p>
<ul>
<li>\u8282\u7701\u5185\u5B58</li>
<li>\u4E0D\u9700\u8981\u7ED9\u5B50\u8282\u70B9\u6CE8\u9500\u4E8B\u4EF6</li>
</ul>
<h2 data-id="heading-5">\u8DE8\u57DF</h2>
<pre><code class="hljs language-!" lang="!">\u6D89\u53CA\u9762\u8BD5\u9898\uFF1A\u4EC0\u4E48\u662F\u8DE8\u57DF\uFF1F\u4E3A\u4EC0\u4E48\u6D4F\u89C8\u5668\u8981\u4F7F\u7528\u540C\u6E90\u7B56\u7565\uFF1F\u4F60\u6709\u51E0\u79CD\u65B9\u5F0F\u53EF\u4EE5\u89E3\u51B3\u8DE8\u57DF\u95EE\u9898\uFF1F\u4E86\u89E3\u9884\u68C0\u8BF7\u6C42\u561B\uFF1F
</code></pre>
<p>\u56E0\u4E3A\u6D4F\u89C8\u5668\u51FA\u4E8E\u5B89\u5168\u8003\u8651\uFF0C\u6709\u540C\u6E90\u7B56\u7565\u3002\u4E5F\u5C31\u662F\u8BF4\uFF0C\u5982\u679C\u534F\u8BAE\u3001\u57DF\u540D\u6216\u8005\u7AEF\u53E3\u6709\u4E00\u4E2A\u4E0D\u540C\u5C31\u662F\u8DE8\u57DF\uFF0CAjax \u8BF7\u6C42\u4F1A\u5931\u8D25\u3002</p>
<p><strong>\u90A3\u4E48\u662F\u51FA\u4E8E\u4EC0\u4E48\u5B89\u5168\u8003\u8651\u624D\u4F1A\u5F15\u5165\u8FD9\u79CD\u673A\u5236\u5462\uFF1F</strong> \u5176\u5B9E\u4E3B\u8981\u662F\u7528\u6765\u9632\u6B62 CSRF \u653B\u51FB\u7684\u3002\u7B80\u5355\u70B9\u8BF4\uFF0CCSRF \u653B\u51FB\u662F\u5229\u7528\u7528\u6237\u7684\u767B\u5F55\u6001\u53D1\u8D77\u6076\u610F\u8BF7\u6C42\u3002</p>
<p>\u4E5F\u5C31\u662F\u8BF4\uFF0C\u6CA1\u6709\u540C\u6E90\u7B56\u7565\u7684\u60C5\u51B5\u4E0B\uFF0CA \u7F51\u7AD9\u53EF\u4EE5\u88AB\u4EFB\u610F\u5176\u4ED6\u6765\u6E90\u7684 Ajax \u8BBF\u95EE\u5230\u5185\u5BB9\u3002\u5982\u679C\u4F60\u5F53\u524D A \u7F51\u7AD9\u8FD8\u5B58\u5728\u767B\u5F55\u6001\uFF0C\u90A3\u4E48\u5BF9\u65B9\u5C31\u53EF\u4EE5\u901A\u8FC7 Ajax \u83B7\u5F97\u4F60\u7684\u4EFB\u4F55\u4FE1\u606F\u3002\u5F53\u7136\u8DE8\u57DF\u5E76\u4E0D\u80FD\u5B8C\u5168\u963B\u6B62 CSRF\u3002</p>
<p><strong>\u7136\u540E\u6211\u4EEC\u6765\u8003\u8651\u4E00\u4E2A\u95EE\u9898\uFF0C\u8BF7\u6C42\u8DE8\u57DF\u4E86\uFF0C\u90A3\u4E48\u8BF7\u6C42\u5230\u5E95\u53D1\u51FA\u53BB\u6CA1\u6709\uFF1F</strong> \u8BF7\u6C42\u5FC5\u7136\u662F\u53D1\u51FA\u53BB\u4E86\uFF0C\u4F46\u662F\u6D4F\u89C8\u5668\u62E6\u622A\u4E86\u54CD\u5E94\u3002\u4F60\u53EF\u80FD\u4F1A\u7591\u95EE\u660E\u660E\u901A\u8FC7\u8868\u5355\u7684\u65B9\u5F0F\u53EF\u4EE5\u53D1\u8D77\u8DE8\u57DF\u8BF7\u6C42\uFF0C\u4E3A\u4EC0\u4E48 Ajax \u5C31\u4E0D\u4F1A\u3002\u56E0\u4E3A\u5F52\u6839\u7ED3\u5E95\uFF0C\u8DE8\u57DF\u662F\u4E3A\u4E86\u963B\u6B62\u7528\u6237\u8BFB\u53D6\u5230\u53E6\u4E00\u4E2A\u57DF\u540D\u4E0B\u7684\u5185\u5BB9\uFF0CAjax \u53EF\u4EE5\u83B7\u53D6\u54CD\u5E94\uFF0C\u6D4F\u89C8\u5668\u8BA4\u4E3A\u8FD9\u4E0D\u5B89\u5168\uFF0C\u6240\u4EE5\u62E6\u622A\u4E86\u54CD\u5E94\u3002\u4F46\u662F\u8868\u5355\u5E76\u4E0D\u4F1A\u83B7\u53D6\u65B0\u7684\u5185\u5BB9\uFF0C\u6240\u4EE5\u53EF\u4EE5\u53D1\u8D77\u8DE8\u57DF\u8BF7\u6C42\u3002\u540C\u65F6\u4E5F\u8BF4\u660E\u4E86\u8DE8\u57DF\u5E76\u4E0D\u80FD\u5B8C\u5168\u963B\u6B62 CSRF\uFF0C\u56E0\u4E3A\u8BF7\u6C42\u6BD5\u7ADF\u662F\u53D1\u51FA\u53BB\u4E86\u3002</p>
<p>\u63A5\u4E0B\u6765\u6211\u4EEC\u5C06\u6765\u5B66\u4E60\u51E0\u79CD\u5E38\u89C1\u7684\u65B9\u5F0F\u6765\u89E3\u51B3\u8DE8\u57DF\u7684\u95EE\u9898\u3002</p>
<h3 data-id="heading-6">JSONP</h3>
<p>JSONP \u7684\u539F\u7406\u5F88\u7B80\u5355\uFF0C\u5C31\u662F\u5229\u7528 <code>&lt;script&gt;</code> \u6807\u7B7E\u6CA1\u6709\u8DE8\u57DF\u9650\u5236\u7684\u6F0F\u6D1E\u3002\u901A\u8FC7 <code>&lt;script&gt;</code> \u6807\u7B7E\u6307\u5411\u4E00\u4E2A\u9700\u8981\u8BBF\u95EE\u7684\u5730\u5740\u5E76\u63D0\u4F9B\u4E00\u4E2A\u56DE\u8C03\u51FD\u6570\u6765\u63A5\u6536\u6570\u636E\u5F53\u9700\u8981\u901A\u8BAF\u65F6\u3002</p>
<pre><code class="hljs language-js" lang="js">&lt;script src=<span class="hljs-string">"http://domain/api?param1=a&amp;param2=b&amp;callback=jsonp"</span>&gt;&lt;/script&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jsonp</span>(<span class="hljs-params">data</span>) </span>{
    	<span class="hljs-built_in">console</span>.log(data)
	}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>    
</code></pre>
<p>JSONP \u4F7F\u7528\u7B80\u5355\u4E14\u517C\u5BB9\u6027\u4E0D\u9519\uFF0C\u4F46\u662F\u53EA\u9650\u4E8E <code>get</code> \u8BF7\u6C42\u3002</p>
<p>\u5728\u5F00\u53D1\u4E2D\u53EF\u80FD\u4F1A\u9047\u5230\u591A\u4E2A JSONP \u8BF7\u6C42\u7684\u56DE\u8C03\u51FD\u6570\u540D\u662F\u76F8\u540C\u7684\uFF0C\u8FD9\u65F6\u5019\u5C31\u9700\u8981\u81EA\u5DF1\u5C01\u88C5\u4E00\u4E2A JSONP\uFF0C\u4EE5\u4E0B\u662F\u7B80\u5355\u5B9E\u73B0</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jsonp</span>(<span class="hljs-params">url, jsonpCallback, success</span>) </span>{
  <span class="hljs-keyword">let</span> script = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'script'</span>)
  script.src = url
  script.async = <span class="hljs-literal">true</span>
  script.type = <span class="hljs-string">'text/javascript'</span>
  <span class="hljs-built_in">window</span>[jsonpCallback] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) </span>{
    success &amp;&amp; success(data)
  }
  <span class="hljs-built_in">document</span>.body.appendChild(script)
}
jsonp(<span class="hljs-string">'http://xxx'</span>, <span class="hljs-string">'callback'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
  <span class="hljs-built_in">console</span>.log(value)
})
</code></pre>
<h3 data-id="heading-7">CORS</h3>
<p>CORS \u9700\u8981\u6D4F\u89C8\u5668\u548C\u540E\u7AEF\u540C\u65F6\u652F\u6301\u3002IE 8 \u548C 9 \u9700\u8981\u901A\u8FC7 <code>XDomainRequest</code> \u6765\u5B9E\u73B0\u3002</p>
<p>\u6D4F\u89C8\u5668\u4F1A\u81EA\u52A8\u8FDB\u884C CORS \u901A\u4FE1\uFF0C\u5B9E\u73B0 CORS \u901A\u4FE1\u7684\u5173\u952E\u662F\u540E\u7AEF\u3002\u53EA\u8981\u540E\u7AEF\u5B9E\u73B0\u4E86 CORS\uFF0C\u5C31\u5B9E\u73B0\u4E86\u8DE8\u57DF\u3002</p>
<p>\u670D\u52A1\u7AEF\u8BBE\u7F6E <code>Access-Control-Allow-Origin</code> \u5C31\u53EF\u4EE5\u5F00\u542F CORS\u3002 \u8BE5\u5C5E\u6027\u8868\u793A\u54EA\u4E9B\u57DF\u540D\u53EF\u4EE5\u8BBF\u95EE\u8D44\u6E90\uFF0C\u5982\u679C\u8BBE\u7F6E\u901A\u914D\u7B26\u5219\u8868\u793A\u6240\u6709\u7F51\u7AD9\u90FD\u53EF\u4EE5\u8BBF\u95EE\u8D44\u6E90\u3002</p>
<p>\u867D\u7136\u8BBE\u7F6E CORS \u548C\u524D\u7AEF\u6CA1\u4EC0\u4E48\u5173\u7CFB\uFF0C\u4F46\u662F\u901A\u8FC7\u8FD9\u79CD\u65B9\u5F0F\u89E3\u51B3\u8DE8\u57DF\u95EE\u9898\u7684\u8BDD\uFF0C\u4F1A\u5728\u53D1\u9001\u8BF7\u6C42\u65F6\u51FA\u73B0\u4E24\u79CD\u60C5\u51B5\uFF0C\u5206\u522B\u4E3A<strong>\u7B80\u5355\u8BF7\u6C42\u548C\u590D\u6742\u8BF7\u6C42</strong>\u3002</p>
<h4 data-id="heading-8">\u7B80\u5355\u8BF7\u6C42</h4>
<p>\u4EE5 Ajax \u4E3A\u4F8B\uFF0C\u5F53\u6EE1\u8DB3\u4EE5\u4E0B\u6761\u4EF6\u65F6\uFF0C\u4F1A\u89E6\u53D1\u7B80\u5355\u8BF7\u6C42</p>
<ol>
<li>
<p>\u4F7F\u7528\u4E0B\u5217\u65B9\u6CD5\u4E4B\u4E00\uFF1A</p>
<ul>
<li>
<p><code>GET</code></p>
</li>
<li>
<p><code>HEAD</code></p>
</li>
<li>
<p><code>POST</code></p>
</li>
</ul>
</li>
<li>
<p><code>Content-Type</code> \u7684\u503C\u4EC5\u9650\u4E8E\u4E0B\u5217\u4E09\u8005\u4E4B\u4E00\uFF1A</p>
<ul>
<li>
<p><code>text/plain</code></p>
</li>
<li>
<p><code>multipart/form-data</code></p>
</li>
<li>
<p><code>application/x-www-form-urlencoded</code></p>
</li>
</ul>
</li>
</ol>
<p>\u8BF7\u6C42\u4E2D\u7684\u4EFB\u610F <code>XMLHttpRequestUpload</code> \u5BF9\u8C61\u5747\u6CA1\u6709\u6CE8\u518C\u4EFB\u4F55\u4E8B\u4EF6\u76D1\u542C\u5668\uFF1B <code>XMLHttpRequestUpload</code> \u5BF9\u8C61\u53EF\u4EE5\u4F7F\u7528 <code>XMLHttpRequest.upload</code> \u5C5E\u6027\u8BBF\u95EE\u3002</p>
<h4 data-id="heading-9">\u590D\u6742\u8BF7\u6C42</h4>
<p>\u90A3\u4E48\u5F88\u663E\u7136\uFF0C\u4E0D\u7B26\u5408\u4EE5\u4E0A\u6761\u4EF6\u7684\u8BF7\u6C42\u5C31\u80AF\u5B9A\u662F\u590D\u6742\u8BF7\u6C42\u4E86\u3002</p>
<p>\u5BF9\u4E8E\u590D\u6742\u8BF7\u6C42\u6765\u8BF4\uFF0C\u9996\u5148\u4F1A\u53D1\u8D77\u4E00\u4E2A\u9884\u68C0\u8BF7\u6C42\uFF0C\u8BE5\u8BF7\u6C42\u662F <code>option</code> \u65B9\u6CD5\u7684\uFF0C\u901A\u8FC7\u8BE5\u8BF7\u6C42\u6765\u77E5\u9053\u670D\u52A1\u7AEF\u662F\u5426\u5141\u8BB8\u8DE8\u57DF\u8BF7\u6C42\u3002</p>
<p>\u5BF9\u4E8E\u9884\u68C0\u8BF7\u6C42\u6765\u8BF4\uFF0C\u5982\u679C\u4F60\u4F7F\u7528\u8FC7 Node \u6765\u8BBE\u7F6E CORS \u7684\u8BDD\uFF0C\u53EF\u80FD\u4F1A\u9047\u5230\u8FC7\u8FD9\u4E48\u4E00\u4E2A\u5751\u3002</p>
<p>\u4EE5\u4E0B\u4EE5 express \u6846\u67B6\u4E3E\u4F8B\uFF1A</p>
<pre><code class="hljs language-js" lang="js">app.use(<span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> {
  res.header(<span class="hljs-string">'Access-Control-Allow-Origin'</span>, <span class="hljs-string">'*'</span>)
  res.header(<span class="hljs-string">'Access-Control-Allow-Methods'</span>, <span class="hljs-string">'PUT, GET, POST, DELETE, OPTIONS'</span>)
  res.header(
    <span class="hljs-string">'Access-Control-Allow-Headers'</span>,
    <span class="hljs-string">'Origin, X-Requested-With, Content-Type, Accept, Authorization, Access-Control-Allow-Credentials'</span>
  )
  next()
})
</code></pre>
<p>\u8BE5\u8BF7\u6C42\u4F1A\u9A8C\u8BC1\u4F60\u7684 <code>Authorization</code> \u5B57\u6BB5\uFF0C\u6CA1\u6709\u7684\u8BDD\u5C31\u4F1A\u62A5\u9519\u3002</p>
<p>\u5F53\u524D\u7AEF\u53D1\u8D77\u4E86\u590D\u6742\u8BF7\u6C42\u540E\uFF0C\u4F60\u4F1A\u53D1\u73B0\u5C31\u7B97\u4F60\u4EE3\u7801\u662F\u6B63\u786E\u7684\uFF0C\u8FD4\u56DE\u7ED3\u679C\u4E5F\u6C38\u8FDC\u662F\u62A5\u9519\u7684\u3002\u56E0\u4E3A\u9884\u68C0\u8BF7\u6C42\u4E5F\u4F1A\u8FDB\u5165\u56DE\u8C03\u4E2D\uFF0C\u4E5F\u4F1A\u89E6\u53D1 <code>next</code> \u65B9\u6CD5\uFF0C\u56E0\u4E3A\u9884\u68C0\u8BF7\u6C42\u5E76\u4E0D\u5305\u542B <code>Authorization</code> \u5B57\u6BB5\uFF0C\u6240\u4EE5\u670D\u52A1\u7AEF\u4F1A\u62A5\u9519\u3002</p>
<p>\u60F3\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\u5F88\u7B80\u5355\uFF0C\u53EA\u9700\u8981\u5728\u56DE\u8C03\u4E2D\u8FC7\u6EE4 <code>option</code> \u65B9\u6CD5\u5373\u53EF</p>
<pre><code class="hljs language-js" lang="js">res.statusCode = <span class="hljs-number">204</span>
res.setHeader(<span class="hljs-string">'Content-Length'</span>, <span class="hljs-string">'0'</span>)
res.end()
</code></pre>
<h3 data-id="heading-10">document.domain</h3>
<p>\u8BE5\u65B9\u5F0F\u53EA\u80FD\u7528\u4E8E<strong>\u4E8C\u7EA7\u57DF\u540D\u76F8\u540C</strong>\u7684\u60C5\u51B5\u4E0B\uFF0C\u6BD4\u5982 <code>a.test.com</code> \u548C <code>b.test.com</code> \u9002\u7528\u4E8E\u8BE5\u65B9\u5F0F\u3002</p>
<p>\u53EA\u9700\u8981\u7ED9\u9875\u9762\u6DFB\u52A0 <code>document.domain = 'test.com'</code> \u8868\u793A\u4E8C\u7EA7\u57DF\u540D\u90FD\u76F8\u540C\u5C31\u53EF\u4EE5\u5B9E\u73B0\u8DE8\u57DF</p>
<h3 data-id="heading-11">postMessage</h3>
<p>\u8FD9\u79CD\u65B9\u5F0F\u901A\u5E38\u7528\u4E8E\u83B7\u53D6\u5D4C\u5165\u9875\u9762\u4E2D\u7684\u7B2C\u4E09\u65B9\u9875\u9762\u6570\u636E\u3002\u4E00\u4E2A\u9875\u9762\u53D1\u9001\u6D88\u606F\uFF0C\u53E6\u4E00\u4E2A\u9875\u9762\u5224\u65AD\u6765\u6E90\u5E76\u63A5\u6536\u6D88\u606F</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// \u53D1\u9001\u6D88\u606F\u7AEF</span>
<span class="hljs-built_in">window</span>.parent.postMessage(<span class="hljs-string">'message'</span>, <span class="hljs-string">'http://test.com'</span>)
<span class="hljs-comment">// \u63A5\u6536\u6D88\u606F\u7AEF</span>
<span class="hljs-keyword">var</span> mc = <span class="hljs-keyword">new</span> MessageChannel()
mc.addEventListener(<span class="hljs-string">'message'</span>, <span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> {
  <span class="hljs-keyword">var</span> origin = event.origin || event.originalEvent.origin
  <span class="hljs-keyword">if</span> (origin === <span class="hljs-string">'http://test.com'</span>) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'\u9A8C\u8BC1\u901A\u8FC7'</span>)
  }
})
</code></pre>
<h2 data-id="heading-12">\u5B58\u50A8</h2>
<pre><code class="hljs language-!" lang="!">\u6D89\u53CA\u9762\u8BD5\u9898\uFF1A\u6709\u51E0\u79CD\u65B9\u5F0F\u53EF\u4EE5\u5B9E\u73B0\u5B58\u50A8\u529F\u80FD\uFF0C\u5206\u522B\u6709\u4EC0\u4E48\u4F18\u7F3A\u70B9\uFF1F\u4EC0\u4E48\u662F Service Worker\uFF1F
</code></pre>
<h3 data-id="heading-13">cookie\uFF0ClocalStorage\uFF0CsessionStorage\uFF0CindexDB</h3>
<p>\u6211\u4EEC\u5148\u6765\u901A\u8FC7\u8868\u683C\u5B66\u4E60\u4E0B\u8FD9\u51E0\u79CD\u5B58\u50A8\u65B9\u5F0F\u7684\u533A\u522B</p>

































<table><thead><tr><th align="center">\u7279\u6027</th><th align="center">cookie</th><th align="center">localStorage</th><th align="center">sessionStorage</th><th align="center">indexDB</th></tr></thead><tbody><tr><td align="center">\u6570\u636E\u751F\u547D\u5468\u671F</td><td align="center">\u4E00\u822C\u7531\u670D\u52A1\u5668\u751F\u6210\uFF0C\u53EF\u4EE5\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4</td><td align="center">\u9664\u975E\u88AB\u6E05\u7406\uFF0C\u5426\u5219\u4E00\u76F4\u5B58\u5728</td><td align="center">\u9875\u9762\u5173\u95ED\u5C31\u6E05\u7406</td><td align="center">\u9664\u975E\u88AB\u6E05\u7406\uFF0C\u5426\u5219\u4E00\u76F4\u5B58\u5728</td></tr><tr><td align="center">\u6570\u636E\u5B58\u50A8\u5927\u5C0F</td><td align="center">4K</td><td align="center">5M</td><td align="center">5M</td><td align="center">\u65E0\u9650</td></tr><tr><td align="center">\u4E0E\u670D\u52A1\u7AEF\u901A\u4FE1</td><td align="center">\u6BCF\u6B21\u90FD\u4F1A\u643A\u5E26\u5728 header \u4E2D\uFF0C\u5BF9\u4E8E\u8BF7\u6C42\u6027\u80FD\u5F71\u54CD</td><td align="center">\u4E0D\u53C2\u4E0E</td><td align="center">\u4E0D\u53C2\u4E0E</td><td align="center">\u4E0D\u53C2\u4E0E</td></tr></tbody></table>
<p>\u4ECE\u4E0A\u8868\u53EF\u4EE5\u770B\u5230\uFF0C<code>cookie</code> \u5DF2\u7ECF\u4E0D\u5EFA\u8BAE\u7528\u4E8E\u5B58\u50A8\u3002\u5982\u679C\u6CA1\u6709\u5927\u91CF\u6570\u636E\u5B58\u50A8\u9700\u6C42\u7684\u8BDD\uFF0C\u53EF\u4EE5\u4F7F\u7528 <code>localStorage</code> \u548C <code>sessionStorage</code> \u3002\u5BF9\u4E8E\u4E0D\u600E\u4E48\u6539\u53D8\u7684\u6570\u636E\u5C3D\u91CF\u4F7F\u7528 <code>localStorage</code> \u5B58\u50A8\uFF0C\u5426\u5219\u53EF\u4EE5\u7528 <code>sessionStorage</code> \u5B58\u50A8\u3002</p>
<p>\u5BF9\u4E8E <code>cookie</code> \u6765\u8BF4\uFF0C\u6211\u4EEC\u8FD8\u9700\u8981\u6CE8\u610F\u5B89\u5168\u6027\u3002</p>

























<table><thead><tr><th align="center">\u5C5E\u6027</th><th align="center">\u4F5C\u7528</th></tr></thead><tbody><tr><td align="center">value</td><td align="center">\u5982\u679C\u7528\u4E8E\u4FDD\u5B58\u7528\u6237\u767B\u5F55\u6001\uFF0C\u5E94\u8BE5\u5C06\u8BE5\u503C\u52A0\u5BC6\uFF0C\u4E0D\u80FD\u4F7F\u7528\u660E\u6587\u7684\u7528\u6237\u6807\u8BC6</td></tr><tr><td align="center">http-only</td><td align="center">\u4E0D\u80FD\u901A\u8FC7 JS \u8BBF\u95EE Cookie\uFF0C\u51CF\u5C11 XSS \u653B\u51FB</td></tr><tr><td align="center">secure</td><td align="center">\u53EA\u80FD\u5728\u534F\u8BAE\u4E3A HTTPS \u7684\u8BF7\u6C42\u4E2D\u643A\u5E26</td></tr><tr><td align="center">same-site</td><td align="center">\u89C4\u5B9A\u6D4F\u89C8\u5668\u4E0D\u80FD\u5728\u8DE8\u57DF\u8BF7\u6C42\u4E2D\u643A\u5E26 Cookie\uFF0C\u51CF\u5C11 CSRF \u653B\u51FB</td></tr></tbody></table>
<h3 data-id="heading-14">Service Worker</h3>
<p>Service Worker \u662F\u8FD0\u884C\u5728\u6D4F\u89C8\u5668\u80CC\u540E\u7684<strong>\u72EC\u7ACB\u7EBF\u7A0B</strong>\uFF0C\u4E00\u822C\u53EF\u4EE5\u7528\u6765\u5B9E\u73B0\u7F13\u5B58\u529F\u80FD\u3002\u4F7F\u7528 Service Worker\u7684\u8BDD\uFF0C\u4F20\u8F93\u534F\u8BAE\u5FC5\u987B\u4E3A <strong>HTTPS</strong>\u3002\u56E0\u4E3A Service Worker \u4E2D\u6D89\u53CA\u5230\u8BF7\u6C42\u62E6\u622A\uFF0C\u6240\u4EE5\u5FC5\u987B\u4F7F\u7528 HTTPS \u534F\u8BAE\u6765\u4FDD\u969C\u5B89\u5168\u3002</p>
<p>Service Worker \u5B9E\u73B0\u7F13\u5B58\u529F\u80FD\u4E00\u822C\u5206\u4E3A\u4E09\u4E2A\u6B65\u9AA4\uFF1A\u9996\u5148\u9700\u8981\u5148\u6CE8\u518C Service Worker\uFF0C\u7136\u540E\u76D1\u542C\u5230 <code>install</code> \u4E8B\u4EF6\u4EE5\u540E\u5C31\u53EF\u4EE5\u7F13\u5B58\u9700\u8981\u7684\u6587\u4EF6\uFF0C\u90A3\u4E48\u5728\u4E0B\u6B21\u7528\u6237\u8BBF\u95EE\u7684\u65F6\u5019\u5C31\u53EF\u4EE5\u901A\u8FC7\u62E6\u622A\u8BF7\u6C42\u7684\u65B9\u5F0F\u67E5\u8BE2\u662F\u5426\u5B58\u5728\u7F13\u5B58\uFF0C\u5B58\u5728\u7F13\u5B58\u7684\u8BDD\u5C31\u53EF\u4EE5\u76F4\u63A5\u8BFB\u53D6\u7F13\u5B58\u6587\u4EF6\uFF0C\u5426\u5219\u5C31\u53BB\u8BF7\u6C42\u6570\u636E\u3002\u4EE5\u4E0B\u662F\u8FD9\u4E2A\u6B65\u9AA4\u7684\u5B9E\u73B0\uFF1A</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// index.js</span>
<span class="hljs-keyword">if</span> (navigator.serviceWorker) {
  navigator.serviceWorker
    .register(<span class="hljs-string">'sw.js'</span>)
    .then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">registration</span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'service worker \u6CE8\u518C\u6210\u529F'</span>)
    })
    .catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'servcie worker \u6CE8\u518C\u5931\u8D25'</span>)
    })
}
<span class="hljs-comment">// sw.js</span>
<span class="hljs-comment">// \u76D1\u542C \`install\` \u4E8B\u4EF6\uFF0C\u56DE\u8C03\u4E2D\u7F13\u5B58\u6240\u9700\u6587\u4EF6</span>
self.addEventListener(<span class="hljs-string">'install'</span>, <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
  e.waitUntil(
    caches.open(<span class="hljs-string">'my-cache'</span>).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">cache</span>) </span>{
      <span class="hljs-keyword">return</span> cache.addAll([<span class="hljs-string">'./index.html'</span>, <span class="hljs-string">'./index.js'</span>])
    })
  )
})

<span class="hljs-comment">// \u62E6\u622A\u6240\u6709\u8BF7\u6C42\u4E8B\u4EF6</span>
<span class="hljs-comment">// \u5982\u679C\u7F13\u5B58\u4E2D\u5DF2\u7ECF\u6709\u8BF7\u6C42\u7684\u6570\u636E\u5C31\u76F4\u63A5\u7528\u7F13\u5B58\uFF0C\u5426\u5219\u53BB\u8BF7\u6C42\u6570\u636E</span>
self.addEventListener(<span class="hljs-string">'fetch'</span>, <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
  e.respondWith(
    caches.match(e.request).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
      <span class="hljs-keyword">if</span> (response) {
        <span class="hljs-keyword">return</span> response
      }
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'fetch source'</span>)
    })
  )
})
</code></pre>
<p>\u6253\u5F00\u9875\u9762\uFF0C\u53EF\u4EE5\u5728\u5F00\u53D1\u8005\u5DE5\u5177\u4E2D\u7684 <code>Application</code> \u770B\u5230 Service Worker \u5DF2\u7ECF\u542F\u52A8\u4E86!<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dacd9c7895d942578c6326dfc3367e22~tplv-k3u1fbpfcp-watermark.awebp" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>\u5728 Cache \u4E2D\u4E5F\u53EF\u4EE5\u53D1\u73B0\u6211\u4EEC\u6240\u9700\u7684\u6587\u4EF6\u5DF2\u88AB\u7F13\u5B58</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/3/28/1626b20dfc4fcd26~tplv-t2oaga2asx-watermark.awebp" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>\u5F53\u6211\u4EEC\u91CD\u65B0\u5237\u65B0\u9875\u9762\u53EF\u4EE5\u53D1\u73B0\u6211\u4EEC\u7F13\u5B58\u7684\u6570\u636E\u662F\u4ECE Service Worker \u4E2D\u8BFB\u53D6\u7684</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9d67e7882fef4ab0a22542757b20763e~tplv-k3u1fbpfcp-watermark.awebp" alt="" loading="lazy" class="medium-zoom-image"></p>
<h2 data-id="heading-15">\u5C0F\u7ED3</h2>
<p>\u4EE5\u4E0A\u5C31\u662F\u6D4F\u89C8\u5668\u57FA\u7840\u77E5\u8BC6\u70B9\u7684\u5185\u5BB9\u4E86\uFF0C\u5982\u679C\u5927\u5BB6\u5BF9\u4E8E\u8FD9\u4E2A\u7AE0\u8282\u7684\u5185\u5BB9\u5B58\u5728\u7591\u95EE\uFF0C\u6B22\u8FCE\u5728\u8BC4\u8BBA\u533A\u4E0E\u6211\u4E92\u52A8\u3002</p><style>.markdown-body pre,.markdown-body pre>code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style>`};export{s as default};
